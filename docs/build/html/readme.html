

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Google Earth Engine SCI and CCI Image Processing Automation &mdash; Snow IPA 4.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=3304f9e4"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CHANGELOG" href="changelog.html" />
    <link rel="prev" title="Google Earth Engine SCI and CCI Image Processing Automation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Snow IPA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#specifying-which-images-to-export">Specifying which images to export</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-as-python-script">Using as Python script</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-as-docker-container">Using as Docker container</a></li>
<li class="toctree-l2"><a class="reference internal" href="#script-arguments">Script arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-container-automatic-scheduled-execution">Docker container automatic scheduled execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#important-notice-about-modis">Important Notice about MODIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#version-history">Version history</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#version-4-0-0">Version 4.0.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="#version-3-0-0">Version 3.0.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#helpful-links">Helpful links</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">CHANGELOG</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v4-0-0">v4.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#breaking-changes">Breaking Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#build-system">Build System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v3-0-0">v3.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id1">Breaking Changes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Snow IPA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Google Earth Engine SCI and CCI Image Processing Automation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/readme.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="google-earth-engine-sci-and-cci-image-processing-automation">
<h1>Google Earth Engine SCI and CCI Image Processing Automation<a class="headerlink" href="#google-earth-engine-sci-and-cci-image-processing-automation" title="Link to this heading"></a></h1>
<p>This project provides a simple python package to process and export images with the monthly average of “Snow Cover Index (SCI)” and “Cloud Cover Index (CCI)” to a GEE Assets folder, a Google Drive Folder or both. Images are created using MODIS images in Google Earth Engine (GEE).</p>
<p>The package is designed to be used with Google Earth Engine and requires a Google service account with the necessary permissions to access the MODIS image collection and export images to GEE Assets or Google Drive. Standard GEE user accounts are currently not supported.</p>
<p>Users can run the package/script manually or automate the export process using a Docker container and by specifying a run frequency following cron rules.</p>
<p>You can find the latest version of the docker image in <a class="reference external" href="https://hub.docker.com/r/ericklinares/gee-nieve-sequia-auto">Docker Hub</a>.</p>
<section id="specifying-which-images-to-export">
<h2>Specifying which images to export<a class="headerlink" href="#specifying-which-images-to-export" title="Link to this heading"></a></h2>
<p>You can specify which images to export with one of the following options:</p>
<ol class="arabic simple">
<li><p>Specify the images by providing a list of months.</p></li>
<li><p>Export the image from the last fully available month in MODIS. Default if no list of months is specified.</p></li>
</ol>
<p>Images already saved in the target folder(s) are skipped. Currently there is no option to overwrite existing images.</p>
<blockquote>
<div><p><strong>Note:</strong> If a list of months is specified and the script is set to run automatically. The list will attempt to export the same images in the list every time but will skip any exports after the first run since it will not try to overwrite existing images.</p>
</div></blockquote>
</section>
<section id="using-as-python-script">
<h2>Using as Python script<a class="headerlink" href="#using-as-python-script" title="Link to this heading"></a></h2>
<p>The export automation package/script is designed so it can be executed as a normal Python script.</p>
<p>The main script “snow_ipa.py” can be executed directly in the console by providing the required information as arguments or as Environment variables.</p>
<p>The script requires a Google service account in the appropriate JSON file format.</p>
<blockquote>
<div><p>Currently only Google Service accounts are supported since they provide the information for both GEE and Google Drive without having to deal with multiple authentication methods.</p>
</div></blockquote>
<p>When running as a script, the process will run once and exit. To automate the execution of the script at regular intervals, use the Docker container version or configure your own cron job in the host machine.</p>
<p>example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>snow_ipa.py<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;&lt;GGE user&gt;&quot;</span><span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;Service account credential file&gt;&quot;</span><span class="w"> </span>-other_arguments...<span class="w"> </span>
</pre></div>
</div>
</section>
<section id="using-as-docker-container">
<h2>Using as Docker container<a class="headerlink" href="#using-as-docker-container" title="Link to this heading"></a></h2>
<p>A Dockerfile and its respective image are also provided as an alternative to run the script as a one-time run or automatically at regular intervals like every day at 3:00 am (local time zone of the server).</p>
<p>The docker container can be configured through environment variables to provide the necessary parameters.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-name<span class="w"> </span>nieve<span class="w"> </span>-e<span class="w"> </span><span class="nv">SNOW_USER</span><span class="o">=</span>user@project.iam.gserviceaccount.com<span class="w"> </span>-e<span class="w"> </span><span class="nv">SNOW_SERVICE_CREDENTIALS_FILE</span><span class="o">=</span>/credentials.json<span class="w"> </span>-v<span class="w"> </span>/path/to/credentials.json:/credentials.json<span class="w"> </span>-e<span class="w"> </span><span class="nv">SNOW_REGIONS_ASSET_PATH</span><span class="o">=</span><span class="s1">&#39;path/to/featurecollection&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">SNOW_EXPORT_TO</span><span class="o">=</span>toAsset<span class="w"> </span>-e<span class="w"> </span><span class="nv">SNOW_GEE_ASSETS_PATH</span><span class="o">=</span><span class="s1">&#39;path/to/save/assets&#39;</span><span class="w"> </span>ericklinares/gee-nieve-sequia-auto:latest
</pre></div>
</div>
<p>See docker-compose.yml for an example of how to deploy using compose files.</p>
</section>
<section id="script-arguments">
<h2>Script arguments<a class="headerlink" href="#script-arguments" title="Link to this heading"></a></h2>
<p>When running manually as a python script. The script accepts the following arguments:</p>
<p><strong>-u or –user (Required)</strong>: Google service account ‘user’ ID. Use the environment variable ‘SNOW_SERVICE_USER’ for the Docker container.</p>
<p><strong>-c or –service-credentials (Required)</strong>: Path to the location of a JSON file with Google service account credentials. Use the environment variable ‘SNOW_SERVICE_CREDENTIALS_FILE’ for the Docker container.</p>
<p><strong>-e or –export-to (Optional)</strong>: Target system to export images. Valid options [toAsset | toDrive | toAssetAndDrive]. Defaults to “toAsset” if no value is provided. Use the environment variable ‘EXPORT_TO’ for the Docker container.</p>
<p><strong>-s or –assets-path (Conditional)</strong>: Target path to a GEE Asset folder for saving images. Required if exporting to GEE Assets. Use the environment variable ‘SNOW_ASSET_PATH’ for the Docker container.</p>
<p><strong>-d or –drive-path (Conditional)</strong>: Target path to a Google Drive folder for saving images. Required if exporting to Google Drive. Use the environment variable ‘SNOW_DRIVE_PATH’ for the Docker container.</p>
<p><strong>-r or –regions-asset-path (Optional)</strong>: GEE asset path for reading geographic regions from FeatureCollection. Defaults to “users/proyectosequiateleamb/Regiones/DPA_regiones_nacional” if not specified. Use the environment variable ‘SNOW_REGIONS_ASSET_PATH’ for the Docker container.</p>
<p><strong>-m or –months-to-export (Optional)</strong>: String of months to export (example: ‘2022-11-01, 2022-10-01’). If not provided the default is to export the last fully available month in MODIS”. Use the environment variable ‘SNOW_MONTHS_LIST’ for the Docker container.</p>
<p><strong>-l or –log-level (Optional)</strong>: Logging level [“DEBUG” | “INFO” | “WARNING” | “ERROR”]. The default value is “INFO”. Use the environment variable ‘SNOW_LOG_LEVEL’ for the Docker container.</p>
<p><strong>–enable-email (Optional)</strong>: Enable email notifications. The default value is False. Use the environment variable ‘SNOW_ENABLE_EMAIL’ for the Docker container.</p>
<p><strong>–smtp-server (Optional)</strong>: SMTP server for sending email notifications. Use the environment variable ‘SNOW_SMTP_SERVER’ for the Docker container.</p>
<p><strong>–smtp-port (Optional)</strong>: SMTP server port for sending email notifications. Use the environment variable ‘SNOW_SMTP_PORT’ for the Docker container.</p>
<p><strong>–smtp-user (Optional)</strong>: Username to log int to SMTP email server. Use the environment variable ‘SNOW_SMTP_USERNAME’ for the Docker container.</p>
<p><strong>–smtp-password (Optional)</strong>: Password to log int to SMTP email server. Use the environment variable ‘SNOW_SMTP_PASSWORD’ for the Docker container.</p>
<p><strong>–smtp-user-file (Optional)</strong>: Path to a file containing the username to log int to SMTP email server. alternative option to –smtp-user. Overwrites –smtp-user if both are provided. Use the environment variable ‘SNOW_SMTP_USERNAME_FILE’ for the Docker container.</p>
<p><strong>–smtp-password-file (Optional)</strong>: Path to a file containing the password to log int to SMTP email server. alternative option to –smtp-password. Overwrites –smtp-password if both are provided. Use the environment variable ‘SNOW_SMTP_PASSWORD_FILE’ for the Docker container.</p>
<p><strong>–from-address (Optional)</strong>: Email address to use as sender. Use the environment variable ‘SNOW_FROM_ADDRESS’ for the Docker container.</p>
<p><strong>–to-address (Optional)</strong>: Email addresses to use as recipients. Accepts one or more email address separated by ‘,’ or ‘;’. Multiple emails need to be enclosed in single or double quotes. e.g “user&#64;email.com;user2&#64;email.com”. Use the environment variable ‘SNOW_TO_ADDRESS’ for the Docker container.</p>
</section>
<section id="docker-container-automatic-scheduled-execution">
<h2>Docker container automatic scheduled execution<a class="headerlink" href="#docker-container-automatic-scheduled-execution" title="Link to this heading"></a></h2>
<p>This project uses cron to schedule the execution of the snow_ipa.py script at a specified interval. Use the following environment variables to configure the scheduler</p>
<p><strong>SNOW_SCHEDULER (Optional)</strong>: Enable the scheduler, otherwise the container will run once and exit. Valid options [True| False | Yes|No, 1|0]. The default value is False. U</p>
<p><strong>SNOW_CRON (Optional)</strong>: Cron expression for the scheduler. The default value is “0 3 * * *”.</p>
</section>
<section id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Link to this heading"></a></h2>
<p>You can substitute command line arguments with the following environment variables.</p>
<ul class="simple">
<li><p>SNOW_USER</p></li>
<li><p>SNOW_SERVICE_CREDENTIALS_FILE</p></li>
<li><p>SNOW_EXPORT_TO</p></li>
<li><p>SNOW_GEE_ASSETS_PATH</p></li>
<li><p>SNOW_GDRIVE_ASSETS_PATH</p></li>
<li><p>SNOW_REGIONS_ASSET_PATH</p></li>
<li><p>SNOW_MONTHS_LIST</p></li>
<li><p>SNOW_LOG_LEVEL</p></li>
<li><p>SNOW_LOG_FILE</p></li>
<li><p>SNOW_ENABLE_EMAIL</p></li>
<li><p>SNOW_SMTP_SERVER</p></li>
<li><p>SNOW_SMTP_PORT</p></li>
<li><p>SNOW_SMTP_USER</p></li>
<li><p>SNOW_SMTP_PASSWORD</p></li>
<li><p>SNOW_SMTP_USER_FILE</p></li>
<li><p>SNOW_SMTP_PASSWORD_FILE</p></li>
<li><p>SNOW_SMTP_FROM_ADDRESS</p></li>
<li><p>SNOW_SMTP_TO_ADDRESS</p></li>
</ul>
<p>For Docker Container only:</p>
<ul class="simple">
<li><p>SNOW_SCHEDULER</p></li>
<li><p>SNOW_CRON</p></li>
</ul>
</section>
<section id="important-notice-about-modis">
<h2>Important Notice about MODIS<a class="headerlink" href="#important-notice-about-modis" title="Link to this heading"></a></h2>
<p>:bell: As of May 2023, due to image availability this script has switched from using MODIS/006/MOD10A1 to MODIS/061/MOD10A1 as the primary image collection. MODIS/006/MOD10A1 is no longer being updated and the last available image is form mid February. Please refer to the official MODIS documentation for more information.</p>
</section>
<section id="version-history">
<h2>Version history<a class="headerlink" href="#version-history" title="Link to this heading"></a></h2>
<section id="version-4-0-0">
<h3>Version 4.0.0<a class="headerlink" href="#version-4-0-0" title="Link to this heading"></a></h3>
<p>:warning: Starting version 4.0.0 the following breaking changes were introduced:</p>
<ul class="simple">
<li><p>Some environment variables were renamed. Please see latest documentation for current names.</p></li>
<li><p>Some console arguments were renamed. Please see latest documentation for current names.</p></li>
<li><p>Users can now specify log file and path.</p></li>
</ul>
</section>
<section id="version-3-0-0">
<h3>Version 3.0.0<a class="headerlink" href="#version-3-0-0" title="Link to this heading"></a></h3>
<p>:warning: Starting version 3.0.0 the following braking changes were introduced:</p>
<ul class="simple">
<li><p>Main script was renamed from “nieve_sequia.py” to “snow_ipa.py”.</p></li>
<li><p>All environment variables were renamed to use the prefix “SNOW_”. For example: “SERVICE_USER” was renamed to “SNOW_SERVICE_USER”.</p></li>
<li><p>One or more console arguments changed names.</p></li>
<li><p>The automated Docker image will no longer run the script automatically. It will only run the script once and exit. Set the environment variables SNOW_SCHEDULER and SNOW_CRON to run the script automatically. This allows users to specify the execution frequency and time.</p></li>
</ul>
</section>
</section>
<section id="helpful-links">
<h2>Helpful links<a class="headerlink" href="#helpful-links" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://hub.docker.com/r/ericklinares/gee-nieve-sequia-auto">Docker Hub image</a></p></li>
<li><p><a class="reference external" href="https://earthengine.google.com/">Google Earth Engine</a></p></li>
<li><p><a class="reference external" href="https://developers.google.com/earth-engine/python_install">Google Earth Engine Python API</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/iam/docs/service-accounts">Google service accounts</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/iam/docs/creating-managing-service-account-keys">Google service account credentials</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Google Earth Engine SCI and CCI Image Processing Automation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="changelog.html" class="btn btn-neutral float-right" title="CHANGELOG" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Laboratorio TeleAmb UPLA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>